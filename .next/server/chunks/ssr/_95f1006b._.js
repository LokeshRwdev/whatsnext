module.exports=[71630,a=>{"use strict";async function b(a){if(204===a.status)return null;let b=a.headers.get("content-type");return b&&b.includes("application/json")?await a.json():null}async function c(a){if(a.ok)return{data:await b(a),error:null};let c=await b(a)||void 0;return{data:null,error:{code:c?.error?.code||`HTTP_${a.status}`,message:c?.error?.message||a.statusText,details:c?.error?.details}}}async function d(a){return c(await fetch(a,{cache:"no-store",credentials:"include"}))}async function e(a,b){return c(await fetch(a,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(b),credentials:"include"}))}async function f(a){return e("/api/pings",a)}async function g(){return d("/api/driver-state")}async function h(a){let b=new URLSearchParams;a?.lat!==void 0&&b.set("lat",String(a.lat)),a?.lon!==void 0&&b.set("lon",String(a.lon)),a?.k!==void 0&&b.set("k",String(a.k));let c=b.toString();return d(`/api/recommendations/next-spot${c?`?${c}`:""}`)}async function i(a){return e("/api/ride-events/ingest",{occurred_at:new Date().toISOString(),...a})}async function j(a){return e("/api/ops-daily/upsert",a)}a.s(["fetchDriverState",()=>g,"fetchRecommendations",()=>h,"postPing",()=>f,"postRideEvent",()=>i,"upsertOpsDaily",()=>j])},92375,a=>{"use strict";var b=a.i(87924),c=a.i(97895);function d({title:a,subtitle:d,actions:e,children:f,className:g}){return(0,b.jsxs)("section",{className:(0,c.cn)("flex h-full flex-col",g),children:[(a||d||e)&&(0,b.jsx)("header",{className:"flex flex-col gap-2 border-b px-4 py-4 text-left",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{children:[a&&(0,b.jsx)("h1",{className:"text-2xl font-semibold leading-tight",children:a}),d&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:d})]}),e&&(0,b.jsx)("div",{className:"shrink-0",children:e})]})}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto px-4 pb-24 pt-4 md:pb-8",children:f})]})}a.s(["DriverShell",()=>d])},97732,a=>{"use strict";var b=a.i(72131);let c=(0,a.i(69240).createBrowserSupabaseClient)();function d(a){let[d,e]=(0,b.useState)(null),[f,g]=(0,b.useState)(!0),[h,i]=(0,b.useState)(null),j=(0,b.useCallback)(async()=>{g(!0);let{data:b,error:d}=await c.from("ops_daily").select("day,platforms,idle_minutes,energy_kwh,energy_cost_inr,fuel_litres,fuel_cost_inr,tolls_parking_inr,notes").eq("day",a).maybeSingle();d&&"PGRST116"!==d.code?i(d.message):(i(null),e(b??null)),g(!1)},[a]);return(0,b.useEffect)(()=>{j()},[j]),{data:d,loading:f,error:h,refresh:j}}a.s(["useOpsDaily",()=>d])},43136,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(56711),e=a.i(92375),f=a.i(97732),g=a.i(71630),h=a.i(40695),i=a.i(23292);let j=(0,d.format)(new Date,"yyyy-MM-dd");function k(){let[a,d]=(0,c.useState)(j),{data:k,refresh:m}=(0,f.useOpsDaily)(a),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)({idle_minutes:"",energy_kwh:"",energy_cost_inr:"",fuel_litres:"",fuel_cost_inr:"",tolls_parking_inr:"",notes:""});(0,c.useEffect)(()=>{k?q({idle_minutes:k.idle_minutes?.toString()??"",energy_kwh:k.energy_kwh?.toString()??"",energy_cost_inr:k.energy_cost_inr?.toString()??"",fuel_litres:k.fuel_litres?.toString()??"",fuel_cost_inr:k.fuel_cost_inr?.toString()??"",tolls_parking_inr:k.tolls_parking_inr?.toString()??"",notes:k.notes??""}):q({idle_minutes:"",energy_kwh:"",energy_cost_inr:"",fuel_litres:"",fuel_cost_inr:"",tolls_parking_inr:"",notes:""})},[k]);let r=a=>b=>{q(c=>({...c,[a]:b.target.value}))},s=async b=>{b.preventDefault(),o(!0);let c={day:a,idle_minutes:p.idle_minutes?Number(p.idle_minutes):void 0,energy_kwh:p.energy_kwh?Number(p.energy_kwh):void 0,energy_cost_inr:p.energy_cost_inr?Number(p.energy_cost_inr):void 0,fuel_litres:p.fuel_litres?Number(p.fuel_litres):void 0,fuel_cost_inr:p.fuel_cost_inr?Number(p.fuel_cost_inr):void 0,tolls_parking_inr:p.tolls_parking_inr?Number(p.tolls_parking_inr):void 0,notes:p.notes||void 0},{error:d}=await (0,g.upsertOpsDaily)(c);(o(!1),d)?i.toast.error(d.message):(i.toast.success("Saved your daily summary"),m())};return(0,b.jsx)(e.DriverShell,{title:"Daily summary",subtitle:"Stay on top of charging + idle time",children:(0,b.jsxs)("form",{className:"space-y-4",onSubmit:s,children:[(0,b.jsxs)("label",{className:"block text-sm",children:["Day",(0,b.jsx)("input",{type:"date",className:"mt-1 w-full rounded-lg border px-3 py-2",value:a,onChange:a=>d(a.target.value)})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,b.jsx)(l,{label:"Idle minutes",value:p.idle_minutes,onChange:r("idle_minutes")}),(0,b.jsx)(l,{label:"Tolls / parking (?)",value:p.tolls_parking_inr,onChange:r("tolls_parking_inr")}),(0,b.jsx)(l,{label:"Energy used (kWh)",value:p.energy_kwh,onChange:r("energy_kwh")}),(0,b.jsx)(l,{label:"Energy cost (?)",value:p.energy_cost_inr,onChange:r("energy_cost_inr")}),(0,b.jsx)(l,{label:"Fuel (L)",value:p.fuel_litres,onChange:r("fuel_litres")}),(0,b.jsx)(l,{label:"Fuel cost (?)",value:p.fuel_cost_inr,onChange:r("fuel_cost_inr")})]}),(0,b.jsxs)("label",{className:"text-sm",children:["Notes",(0,b.jsx)("textarea",{className:"mt-1 w-full rounded-lg border px-3 py-2",rows:3,value:p.notes,onChange:r("notes"),placeholder:"Anything special about today?"})]}),(0,b.jsx)(h.Button,{type:"submit",className:"w-full",disabled:n,children:n?"Saving.":"Save daily summary"})]})})}function l({label:a,value:c,onChange:d}){return(0,b.jsxs)("label",{className:"text-sm",children:[a,(0,b.jsx)("input",{type:"number",inputMode:"decimal",className:"mt-1 w-full rounded-lg border px-3 py-2",value:c,onChange:d,placeholder:"0"})]})}a.s(["default",()=>k])}];

//# sourceMappingURL=_95f1006b._.js.map