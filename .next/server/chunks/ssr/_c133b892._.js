module.exports=[3130,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97895);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-2xl border bg-card text-card-foreground shadow-sm",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h3",{ref:e,className:(0,d.cn)("text-2xl font-semibold leading-none tracking-tight",a),...c}));g.displayName="CardTitle",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("p",{ref:e,className:(0,d.cn)("text-sm text-muted-foreground",a),...c})).displayName="CardDescription";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));h.displayName="CardContent",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c})).displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>h,"CardHeader",()=>f,"CardTitle",()=>g])},97732,a=>{"use strict";var b=a.i(72131);let c=(0,a.i(69240).createBrowserSupabaseClient)();function d(a){let[d,e]=(0,b.useState)(null),[f,g]=(0,b.useState)(!0),[h,i]=(0,b.useState)(null),j=(0,b.useCallback)(async()=>{g(!0);let{data:b,error:d}=await c.from("ops_daily").select("day,platforms,idle_minutes,energy_kwh,energy_cost_inr,fuel_litres,fuel_cost_inr,tolls_parking_inr,notes").eq("day",a).maybeSingle();d&&"PGRST116"!==d.code?i(d.message):(i(null),e(b??null)),g(!1)},[a]);return(0,b.useEffect)(()=>{j()},[j]),{data:d,loading:f,error:h,refresh:j}}a.s(["useOpsDaily",()=>d])},92375,a=>{"use strict";var b=a.i(87924),c=a.i(97895);function d({title:a,subtitle:d,actions:e,children:f,className:g}){return(0,b.jsxs)("section",{className:(0,c.cn)("flex h-full flex-col",g),children:[(a||d||e)&&(0,b.jsx)("header",{className:"flex flex-col gap-2 border-b px-4 py-4 text-left",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{children:[a&&(0,b.jsx)("h1",{className:"text-2xl font-semibold leading-tight",children:a}),d&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:d})]}),e&&(0,b.jsx)("div",{className:"shrink-0",children:e})]})}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto px-4 pb-24 pt-4 md:pb-8",children:f})]})}a.s(["DriverShell",()=>d])},69520,a=>{"use strict";let b=(0,a.i(70106).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);a.s(["RefreshCw",()=>b],69520)},15711,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(56711),e=a.i(67638),f=a.i(92375),g=a.i(69240);let h=(0,g.createBrowserSupabaseClient)(),i=(0,g.createBrowserSupabaseClient)();var j=a.i(97732),k=a.i(40695),l=a.i(3130),m=a.i(69520);function n(){let[a,g]=(0,c.useState)((0,e.startOfDay)(new Date)),[n,p]=(0,c.useState)(new Date),[q,r]=(0,c.useState)("all"),{trips:s,stats:t,loading:u,error:v,refresh:w}=function({from:a,to:b,platform:d="all"}){let e=function(){let[a,b]=(0,c.useState)({});return(0,c.useEffect)(()=>{let a=!0;return async function(){let{data:c}=await h.from("zones").select("id,name");if(!a||!c)return;let d={};for(let a of c)d[a.id]=a.name;b(d)}(),()=>{a=!1}},[]),a}(),[f,g]=(0,c.useState)([]),[j,k]=(0,c.useState)(!0),[l,m]=(0,c.useState)(null),n=(0,c.useCallback)(async()=>{k(!0);let c=i.from("trips").select("id,pickup_at,drop_at,platform,pickup_zone,drop_zone,fare_inr,distance_km,tip_inr,deadhead_km").order("pickup_at",{ascending:!1}).gte("pickup_at",a.toISOString()).lte("pickup_at",b.toISOString()).limit(100);"all"!==d&&(c=c.eq("platform",d));let{data:e,error:f}=await c;f?m(f.message):(m(null),g(e??[])),k(!1)},[a,b,d]);(0,c.useEffect)(()=>{n()},[n]);let o=(0,c.useMemo)(()=>f.length?f.reduce((a,b)=>{a.totalTrips+=1,a.totalEarnings+=(b.fare_inr??0)+(b.tip_inr??0);let c=b.pickup_at?Date.parse(b.pickup_at):0,d=b.drop_at?Date.parse(b.drop_at):c;return a.totalHours+=Math.max(0,d-c)/36e5,a.deadheadKm+=b.deadhead_km??0,a},{totalTrips:0,totalEarnings:0,totalHours:0,deadheadKm:0}):{totalTrips:0,totalEarnings:0,totalHours:0,deadheadKm:0},[f]);return{trips:(0,c.useMemo)(()=>f.map(a=>({...a,pickup_zone_name:a.pickup_zone?e[a.pickup_zone]??`Zone ${a.pickup_zone}`:"",drop_zone_name:a.drop_zone?e[a.drop_zone]??`Zone ${a.drop_zone}`:""})),[f,e]),loading:j,error:l,stats:o,refresh:n}}({from:a,to:n,platform:q}),x=(0,d.format)(a,"yyyy-MM-dd"),y=x===(0,d.format)(n,"yyyy-MM-dd"),{data:z}=(0,j.useOpsDaily)(x),A=a=>b=>{a(new Date(`${b.target.value}T00:00:00`))};return(0,b.jsx)(f.DriverShell,{title:"Trips & Earnings",subtitle:"Track performance and demand",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-3 rounded-2xl border bg-card p-4 shadow-sm sm:grid-cols-5",children:[(0,b.jsx)(o,{label:"Total trips",value:t.totalTrips.toString()}),(0,b.jsx)(o,{label:"Earnings",value:`?${t.totalEarnings.toFixed(0)}`}),(0,b.jsx)(o,{label:"? / hour",value:t.totalHours>0?`?${(t.totalEarnings/t.totalHours).toFixed(0)}`:"--"}),(0,b.jsx)(o,{label:"Deadhead km",value:`${t.deadheadKm.toFixed(1)} km`}),(0,b.jsx)(o,{label:"Idle minutes",value:y?z?.idle_minutes?.toString()??"--":"Select 1 day"})]}),(0,b.jsx)("div",{className:"rounded-2xl border p-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-4",children:[(0,b.jsxs)("label",{className:"text-sm",children:["From",(0,b.jsx)("input",{type:"date",className:"mt-1 w-full rounded-lg border px-3 py-2",value:(0,d.format)(a,"yyyy-MM-dd"),onChange:A(g)})]}),(0,b.jsxs)("label",{className:"text-sm",children:["To",(0,b.jsx)("input",{type:"date",className:"mt-1 w-full rounded-lg border px-3 py-2",value:(0,d.format)(n,"yyyy-MM-dd"),onChange:A(p)})]}),(0,b.jsxs)("div",{className:"text-sm",children:["Platform",(0,b.jsx)("div",{className:"mt-1 inline-flex gap-2 rounded-full bg-muted p-1",children:["all","ola","uber"].map(a=>(0,b.jsx)("button",{className:`rounded-full px-3 py-1 text-xs font-semibold capitalize transition ${q===a?"bg-white text-foreground shadow":"text-muted-foreground"}`,onClick:()=>r(a),children:a},a))})]}),(0,b.jsx)("div",{className:"flex items-end",children:(0,b.jsxs)(k.Button,{onClick:w,disabled:u,className:"w-full",variant:"secondary",children:[(0,b.jsx)(m.RefreshCw,{className:"mr-2 h-4 w-4"})," Refresh"]})})]})}),v&&(0,b.jsx)("p",{className:"text-sm text-red-600",children:v}),(0,b.jsxs)("div",{className:"space-y-3",children:[u&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading trips."}),!u&&0===s.length&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No trips in this range."}),s.map(a=>(0,b.jsxs)(l.Card,{className:"space-y-2 p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"font-semibold capitalize",children:a.platform}),(0,b.jsxs)("span",{className:"text-muted-foreground",children:[a.pickup_at?(0,d.format)(new Date(a.pickup_at),"MMM d, h:mm a"):"--"," ","->"," ",a.drop_at?(0,d.format)(new Date(a.drop_at),"h:mm a"):"--"]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Pickup"}),(0,b.jsx)("p",{className:"font-medium",children:a.pickup_zone_name||"Unknown"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Drop"}),(0,b.jsx)("p",{className:"font-medium",children:a.drop_zone_name||"Unknown"})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{children:a.distance_km?`${a.distance_km.toFixed(1)} km`:"--"}),(0,b.jsxs)("span",{className:"font-semibold",children:["?",((a.fare_inr??0)+(a.tip_inr??0)).toFixed(0)]})]})]},a.id))]})]})})}function o({label:a,value:c}){return(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs uppercase text-muted-foreground",children:a}),(0,b.jsx)("p",{className:"text-2xl font-semibold",children:c})]})}a.s(["default",()=>n],15711)}];

//# sourceMappingURL=_c133b892._.js.map