module.exports=[3130,91838,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97895);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-2xl border bg-card text-card-foreground shadow-sm",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h3",{ref:e,className:(0,d.cn)("text-2xl font-semibold leading-none tracking-tight",a),...c}));g.displayName="CardTitle",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("p",{ref:e,className:(0,d.cn)("text-sm text-muted-foreground",a),...c})).displayName="CardDescription";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));function i({children:a,title:c,subtitle:d}){return(0,b.jsxs)("section",{className:"flex flex-col h-full",children:[(c||d)&&(0,b.jsxs)("div",{className:"px-4 py-6 border-b",children:[c&&(0,b.jsx)("h1",{className:"text-2xl font-bold mb-1",children:c}),d&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:d})]}),(0,b.jsx)("div",{className:"flex-1 overflow-auto",children:a})]})}h.displayName="CardContent",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c})).displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>h,"CardHeader",()=>f,"CardTitle",()=>g],3130),a.s(["PageShell",()=>i],91838)},5522,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97895);let e=c.forwardRef(({className:a,type:c,...e},f)=>(0,b.jsx)("input",{type:c,className:(0,d.cn)("flex h-10 w-full rounded-md border border-input bg-bg px-3 py-2 text-sm ring-offset-bg file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:f,...e}));e.displayName="Input",a.s(["Input",()=>e])},24987,a=>{"use strict";let b=(0,a.i(70106).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);a.s(["MapPin",()=>b],24987)},68275,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(70106);let e=(0,d.default)("car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);var f=a.i(24987);let g=(0,d.default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);var h=a.i(40695),i=a.i(3130),j=a.i(5522),k=a.i(91838),l=a.i(97895);function m({label:a,variant:c="default",className:d}){return(0,b.jsx)("span",{className:(0,l.cn)("inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium",{default:"bg-muted text-muted-foreground",success:"bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-400",warning:"bg-amber-100 dark:bg-amber-900/20 text-amber-700 dark:text-amber-400"}[c],d),children:a})}var n=a.i(68515),o=a.i(95659);async function p(a){let{data:{session:b}}=await o.supabase.auth.getSession();if(!b)return console.error("[sendRideEvent] No session; user must be logged in."),{ok:!1,error:"UNAUTHORIZED"};try{let{data:b,error:c}=await o.supabase.functions.invoke("ingest_ride_event",{body:a});if(c)return console.error("[sendRideEvent] Supabase function error:",c),{ok:!1,error:c.message??"FUNCTION_ERROR"};return console.log("[sendRideEvent] Success:",b),{ok:!0,data:b}}catch(a){return console.error("[sendRideEvent] Unexpected error:",a),{ok:!1,error:a?.message??"UNKNOWN_ERROR"}}}var q=a.i(50944),r=a.i(23292);async function s(){return new Promise(a=>navigator.geolocation.getCurrentPosition(b=>a({lat:b.coords.latitude,lon:b.coords.longitude}),()=>a({lat:null,lon:null}),{enableHighAccuracy:!0,maximumAge:5e3,timeout:1e4}))}async function t(a,b){let c=await s();return(await p({event_type:a,occurred_at:new Date().toISOString(),battery_pct:b,...c})).ok}function u(){let[a,d]=(0,c.useState)("seeking"),[l,o]=(0,c.useState)(!1),p=(0,n.useAppStore)(a=>a.battery);(0,q.useRouter)();let s=(0,n.useAppStore)(a=>a.setBattery),u=async(a,b)=>{o(!0);try{await t(a,p)?(r.toast.success("Event recorded successfully!"),d(b)):r.toast.error("Failed to record event. Saved offline.")}catch(a){r.toast.error("An error occurred")}finally{o(!1)}};return(0,b.jsx)(k.PageShell,{children:(0,b.jsxs)("div",{className:"p-4 space-y-4",children:[(0,b.jsxs)(i.Card,{className:"shadow-md",children:[(0,b.jsxs)(i.CardHeader,{children:[(0,b.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(e,{className:"h-6 w-6 text-primary"}),"Patna EV Co-Pilot"]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["seeking"===a&&"Ready for your next ride","booked"===a&&"Booking confirmed","ontrip"===a&&"Trip in progress"]})]}),(0,b.jsxs)(i.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Battery Level (Optional)"}),(0,b.jsx)(j.Input,{type:"number",min:"0",max:"100",placeholder:"e.g. 75",value:p||"",onChange:a=>s(a.target.value?Number(a.target.value):null),className:"text-center text-lg"})]}),"seeking"===a&&(0,b.jsx)(h.Button,{size:"lg",className:"w-full h-14 text-lg",onClick:()=>u("booking_received","booked"),disabled:l,children:"Got a Ride"}),"booked"===a&&(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsx)(h.Button,{size:"lg",onClick:()=>u("ride_started","ontrip"),disabled:l,className:"h-14",children:"Start Trip"}),(0,b.jsx)(h.Button,{size:"lg",variant:"outline",onClick:()=>u("booking_cancelled","seeking"),disabled:l,className:"h-14",children:"Cancel"})]}),"ontrip"===a&&(0,b.jsx)(h.Button,{size:"lg",className:"w-full h-14 text-lg",onClick:()=>u("ride_completed","seeking"),disabled:l,children:"End Trip"})]})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsxs)(i.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(g,{className:"h-5 w-5"}),"Recommended Zones"]})}),(0,b.jsx)(i.CardContent,{className:"space-y-3",children:[{name:"Airport",reason:"High demand",variant:"success"},{name:"P&M Mall",reason:"Event nearby",variant:"warning"},{name:"Patna Junction",reason:"Popular now",variant:"default"}].map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50 hover:bg-muted transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.MapPin,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"font-medium",children:a.name})]}),(0,b.jsx)(m,{label:a.reason,variant:a.variant})]},a.name))})]})]})})}a.s(["default",()=>u],68275)}];

//# sourceMappingURL=_389dad51._.js.map