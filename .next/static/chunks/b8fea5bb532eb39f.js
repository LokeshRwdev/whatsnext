(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70065,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(47163);let r=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("rounded-2xl border bg-card text-card-foreground shadow-sm",e),...a}));r.displayName="Card";let l=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",e),...a}));l.displayName="CardHeader";let i=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("h3",{ref:r,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",e),...a}));i.displayName="CardTitle",a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("p",{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",e),...a})).displayName="CardDescription";let d=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",e),...a}));d.displayName="CardContent",a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",e),...a})).displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>d,"CardHeader",()=>l,"CardTitle",()=>i])},95112,e=>{"use strict";var t=e.i(71645);let a=(0,e.i(20755).createBrowserSupabaseClient)();function s(e){let[s,r]=(0,t.useState)(null),[l,i]=(0,t.useState)(!0),[d,n]=(0,t.useState)(null),o=(0,t.useCallback)(async()=>{i(!0);let{data:t,error:s}=await a.from("ops_daily").select("day,platforms,idle_minutes,energy_kwh,energy_cost_inr,fuel_litres,fuel_cost_inr,tolls_parking_inr,notes").eq("day",e).maybeSingle();s&&"PGRST116"!==s.code?n(s.message):(n(null),r(t??null)),i(!1)},[e]);return(0,t.useEffect)(()=>{o()},[o]),{data:s,loading:l,error:d,refresh:o}}e.s(["useOpsDaily",()=>s])},62786,e=>{"use strict";var t=e.i(43476),a=e.i(47163);function s({title:e,subtitle:s,actions:r,children:l,className:i}){return(0,t.jsxs)("section",{className:(0,a.cn)("flex h-full flex-col",i),children:[(e||s||r)&&(0,t.jsx)("header",{className:"flex flex-col gap-2 border-b px-4 py-4 text-left",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{children:[e&&(0,t.jsx)("h1",{className:"text-2xl font-semibold leading-tight",children:e}),s&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:s})]}),r&&(0,t.jsx)("div",{className:"shrink-0",children:r})]})}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto px-4 pb-24 pt-4 md:pb-8",children:l})]})}e.s(["DriverShell",()=>s])},16715,e=>{"use strict";let t=(0,e.i(75254).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},37833,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(1851),r=e.i(85890),l=e.i(62786),i=e.i(20755);let d=(0,i.createBrowserSupabaseClient)(),n=(0,i.createBrowserSupabaseClient)();var o=e.i(95112),c=e.i(67881),m=e.i(70065),p=e.i(16715);function u(){let[e,i]=(0,a.useState)((0,r.startOfDay)(new Date)),[u,f]=(0,a.useState)(new Date),[h,g]=(0,a.useState)("all"),{trips:j,stats:y,loading:N,error:_,refresh:v}=function({from:e,to:t,platform:s="all"}){let r=function(){let[e,t]=(0,a.useState)({});return(0,a.useEffect)(()=>{let e=!0;return async function(){let{data:a}=await d.from("zones").select("id,name");if(!e||!a)return;let s={};for(let e of a)s[e.id]=e.name;t(s)}(),()=>{e=!1}},[]),e}(),[l,i]=(0,a.useState)([]),[o,c]=(0,a.useState)(!0),[m,p]=(0,a.useState)(null),u=(0,a.useCallback)(async()=>{c(!0);let a=n.from("trips").select("id,pickup_at,drop_at,platform,pickup_zone,drop_zone,fare_inr,distance_km,tip_inr,deadhead_km").order("pickup_at",{ascending:!1}).gte("pickup_at",e.toISOString()).lte("pickup_at",t.toISOString()).limit(100);"all"!==s&&(a=a.eq("platform",s));let{data:r,error:l}=await a;l?p(l.message):(p(null),i(r??[])),c(!1)},[e,t,s]);(0,a.useEffect)(()=>{u()},[u]);let x=(0,a.useMemo)(()=>l.length?l.reduce((e,t)=>{e.totalTrips+=1,e.totalEarnings+=(t.fare_inr??0)+(t.tip_inr??0);let a=t.pickup_at?Date.parse(t.pickup_at):0,s=t.drop_at?Date.parse(t.drop_at):a;return e.totalHours+=Math.max(0,s-a)/36e5,e.deadheadKm+=t.deadhead_km??0,e},{totalTrips:0,totalEarnings:0,totalHours:0,deadheadKm:0}):{totalTrips:0,totalEarnings:0,totalHours:0,deadheadKm:0},[l]);return{trips:(0,a.useMemo)(()=>l.map(e=>({...e,pickup_zone_name:e.pickup_zone?r[e.pickup_zone]??`Zone ${e.pickup_zone}`:"",drop_zone_name:e.drop_zone?r[e.drop_zone]??`Zone ${e.drop_zone}`:""})),[l,r]),loading:o,error:m,stats:x,refresh:u}}({from:e,to:u,platform:h}),b=(0,s.format)(e,"yyyy-MM-dd"),k=b===(0,s.format)(u,"yyyy-MM-dd"),{data:w}=(0,o.useOpsDaily)(b),C=e=>t=>{e(new Date(`${t.target.value}T00:00:00`))};return(0,t.jsx)(l.DriverShell,{title:"Trips & Earnings",subtitle:"Track performance and demand",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3 rounded-2xl border bg-card p-4 shadow-sm sm:grid-cols-5",children:[(0,t.jsx)(x,{label:"Total trips",value:y.totalTrips.toString()}),(0,t.jsx)(x,{label:"Earnings",value:`?${y.totalEarnings.toFixed(0)}`}),(0,t.jsx)(x,{label:"? / hour",value:y.totalHours>0?`?${(y.totalEarnings/y.totalHours).toFixed(0)}`:"--"}),(0,t.jsx)(x,{label:"Deadhead km",value:`${y.deadheadKm.toFixed(1)} km`}),(0,t.jsx)(x,{label:"Idle minutes",value:k?w?.idle_minutes?.toString()??"--":"Select 1 day"})]}),(0,t.jsx)("div",{className:"rounded-2xl border p-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-4",children:[(0,t.jsxs)("label",{className:"text-sm",children:["From",(0,t.jsx)("input",{type:"date",className:"mt-1 w-full rounded-lg border px-3 py-2",value:(0,s.format)(e,"yyyy-MM-dd"),onChange:C(i)})]}),(0,t.jsxs)("label",{className:"text-sm",children:["To",(0,t.jsx)("input",{type:"date",className:"mt-1 w-full rounded-lg border px-3 py-2",value:(0,s.format)(u,"yyyy-MM-dd"),onChange:C(f)})]}),(0,t.jsxs)("div",{className:"text-sm",children:["Platform",(0,t.jsx)("div",{className:"mt-1 inline-flex gap-2 rounded-full bg-muted p-1",children:["all","ola","uber"].map(e=>(0,t.jsx)("button",{className:`rounded-full px-3 py-1 text-xs font-semibold capitalize transition ${h===e?"bg-white text-foreground shadow":"text-muted-foreground"}`,onClick:()=>g(e),children:e},e))})]}),(0,t.jsx)("div",{className:"flex items-end",children:(0,t.jsxs)(c.Button,{onClick:v,disabled:N,className:"w-full",variant:"secondary",children:[(0,t.jsx)(p.RefreshCw,{className:"mr-2 h-4 w-4"})," Refresh"]})})]})}),_&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:_}),(0,t.jsxs)("div",{className:"space-y-3",children:[N&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading trips."}),!N&&0===j.length&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"No trips in this range."}),j.map(e=>(0,t.jsxs)(m.Card,{className:"space-y-2 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsx)("span",{className:"font-semibold capitalize",children:e.platform}),(0,t.jsxs)("span",{className:"text-muted-foreground",children:[e.pickup_at?(0,s.format)(new Date(e.pickup_at),"MMM d, h:mm a"):"--"," ","->"," ",e.drop_at?(0,s.format)(new Date(e.drop_at),"h:mm a"):"--"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Pickup"}),(0,t.jsx)("p",{className:"font-medium",children:e.pickup_zone_name||"Unknown"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Drop"}),(0,t.jsx)("p",{className:"font-medium",children:e.drop_zone_name||"Unknown"})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsx)("span",{children:e.distance_km?`${e.distance_km.toFixed(1)} km`:"--"}),(0,t.jsxs)("span",{className:"font-semibold",children:["?",((e.fare_inr??0)+(e.tip_inr??0)).toFixed(0)]})]})]},e.id))]})]})})}function x({label:e,value:a}){return(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs uppercase text-muted-foreground",children:e}),(0,t.jsx)("p",{className:"text-2xl font-semibold",children:a})]})}e.s(["default",()=>u],37833)}]);