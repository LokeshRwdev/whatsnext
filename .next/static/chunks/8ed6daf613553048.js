(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,44215,e=>{"use strict";async function t(e){if(204===e.status)return null;let t=e.headers.get("content-type");return t&&t.includes("application/json")?await e.json():null}async function n(e){if(e.ok)return{data:await t(e),error:null};let n=await t(e)||void 0;return{data:null,error:{code:n?.error?.code||`HTTP_${e.status}`,message:n?.error?.message||e.statusText,details:n?.error?.details}}}async function s(e){return n(await fetch(e,{cache:"no-store",credentials:"include"}))}async function l(e,t){return n(await fetch(e,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t),credentials:"include"}))}async function r(e){return l("/api/pings",e)}async function i(){return s("/api/driver-state")}async function a(e){let t=new URLSearchParams;e?.lat!==void 0&&t.set("lat",String(e.lat)),e?.lon!==void 0&&t.set("lon",String(e.lon)),e?.k!==void 0&&t.set("k",String(e.k));let n=t.toString();return s(`/api/recommendations/next-spot${n?`?${n}`:""}`)}async function o(e){return l("/api/ride-events/ingest",{occurred_at:new Date().toISOString(),...e})}async function u(e){return l("/api/ops-daily/upsert",e)}e.s(["fetchDriverState",()=>i,"fetchRecommendations",()=>a,"postPing",()=>r,"postRideEvent",()=>o,"upsertOpsDaily",()=>u])},62786,e=>{"use strict";var t=e.i(43476),n=e.i(47163);function s({title:e,subtitle:s,actions:l,children:r,className:i}){return(0,t.jsxs)("section",{className:(0,n.cn)("flex h-full flex-col",i),children:[(e||s||l)&&(0,t.jsx)("header",{className:"flex flex-col gap-2 border-b px-4 py-4 text-left",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{children:[e&&(0,t.jsx)("h1",{className:"text-2xl font-semibold leading-tight",children:e}),s&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:s})]}),l&&(0,t.jsx)("div",{className:"shrink-0",children:l})]})}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto px-4 pb-24 pt-4 md:pb-8",children:r})]})}e.s(["DriverShell",()=>s])},95112,e=>{"use strict";var t=e.i(71645);let n=(0,e.i(20755).createBrowserSupabaseClient)();function s(e){let[s,l]=(0,t.useState)(null),[r,i]=(0,t.useState)(!0),[a,o]=(0,t.useState)(null),u=(0,t.useCallback)(async()=>{i(!0);let{data:t,error:s}=await n.from("ops_daily").select("day,platforms,idle_minutes,energy_kwh,energy_cost_inr,fuel_litres,fuel_cost_inr,tolls_parking_inr,notes").eq("day",e).maybeSingle();s&&"PGRST116"!==s.code?o(s.message):(o(null),l(t??null)),i(!1)},[e]);return(0,t.useEffect)(()=>{u()},[u]),{data:s,loading:r,error:a,refresh:u}}e.s(["useOpsDaily",()=>s])},61375,e=>{"use strict";var t=e.i(43476),n=e.i(71645),s=e.i(1851),l=e.i(62786),r=e.i(95112),i=e.i(44215),a=e.i(67881),o=e.i(46696);let u=(0,s.format)(new Date,"yyyy-MM-dd");function c(){let[e,s]=(0,n.useState)(u),{data:c,refresh:_}=(0,r.useOpsDaily)(e),[g,m]=(0,n.useState)(!1),[y,f]=(0,n.useState)({idle_minutes:"",energy_kwh:"",energy_cost_inr:"",fuel_litres:"",fuel_cost_inr:"",tolls_parking_inr:"",notes:""});(0,n.useEffect)(()=>{c?f({idle_minutes:c.idle_minutes?.toString()??"",energy_kwh:c.energy_kwh?.toString()??"",energy_cost_inr:c.energy_cost_inr?.toString()??"",fuel_litres:c.fuel_litres?.toString()??"",fuel_cost_inr:c.fuel_cost_inr?.toString()??"",tolls_parking_inr:c.tolls_parking_inr?.toString()??"",notes:c.notes??""}):f({idle_minutes:"",energy_kwh:"",energy_cost_inr:"",fuel_litres:"",fuel_cost_inr:"",tolls_parking_inr:"",notes:""})},[c]);let p=e=>t=>{f(n=>({...n,[e]:t.target.value}))},h=async t=>{t.preventDefault(),m(!0);let n={day:e,idle_minutes:y.idle_minutes?Number(y.idle_minutes):void 0,energy_kwh:y.energy_kwh?Number(y.energy_kwh):void 0,energy_cost_inr:y.energy_cost_inr?Number(y.energy_cost_inr):void 0,fuel_litres:y.fuel_litres?Number(y.fuel_litres):void 0,fuel_cost_inr:y.fuel_cost_inr?Number(y.fuel_cost_inr):void 0,tolls_parking_inr:y.tolls_parking_inr?Number(y.tolls_parking_inr):void 0,notes:y.notes||void 0},{error:s}=await (0,i.upsertOpsDaily)(n);(m(!1),s)?o.toast.error(s.message):(o.toast.success("Saved your daily summary"),_())};return(0,t.jsx)(l.DriverShell,{title:"Daily summary",subtitle:"Stay on top of charging + idle time",children:(0,t.jsxs)("form",{className:"space-y-4",onSubmit:h,children:[(0,t.jsxs)("label",{className:"block text-sm",children:["Day",(0,t.jsx)("input",{type:"date",className:"mt-1 w-full rounded-lg border px-3 py-2",value:e,onChange:e=>s(e.target.value)})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,t.jsx)(d,{label:"Idle minutes",value:y.idle_minutes,onChange:p("idle_minutes")}),(0,t.jsx)(d,{label:"Tolls / parking (?)",value:y.tolls_parking_inr,onChange:p("tolls_parking_inr")}),(0,t.jsx)(d,{label:"Energy used (kWh)",value:y.energy_kwh,onChange:p("energy_kwh")}),(0,t.jsx)(d,{label:"Energy cost (?)",value:y.energy_cost_inr,onChange:p("energy_cost_inr")}),(0,t.jsx)(d,{label:"Fuel (L)",value:y.fuel_litres,onChange:p("fuel_litres")}),(0,t.jsx)(d,{label:"Fuel cost (?)",value:y.fuel_cost_inr,onChange:p("fuel_cost_inr")})]}),(0,t.jsxs)("label",{className:"text-sm",children:["Notes",(0,t.jsx)("textarea",{className:"mt-1 w-full rounded-lg border px-3 py-2",rows:3,value:y.notes,onChange:p("notes"),placeholder:"Anything special about today?"})]}),(0,t.jsx)(a.Button,{type:"submit",className:"w-full",disabled:g,children:g?"Saving.":"Save daily summary"})]})})}function d({label:e,value:n,onChange:s}){return(0,t.jsxs)("label",{className:"text-sm",children:[e,(0,t.jsx)("input",{type:"number",inputMode:"decimal",className:"mt-1 w-full rounded-lg border px-3 py-2",value:n,onChange:s,placeholder:"0"})]})}e.s(["default",()=>c])}]);