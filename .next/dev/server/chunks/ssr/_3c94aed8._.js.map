{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lokes/Desktop/projects/whatsnext/components/layout/DriverShell.tsx"],"sourcesContent":["import { ReactNode } from \"react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface DriverShellProps {\n  title?: string;\n  subtitle?: string;\n  actions?: ReactNode;\n  children: ReactNode;\n  className?: string;\n}\n\nexport function DriverShell({ title, subtitle, actions, children, className }: DriverShellProps) {\n  return (\n    <section className={cn(\"flex h-full flex-col\", className)}>\n      {(title || subtitle || actions) && (\n        <header className=\"flex flex-col gap-2 border-b px-4 py-4 text-left\">\n          <div className=\"flex items-start justify-between gap-3\">\n            <div>\n              {title && <h1 className=\"text-2xl font-semibold leading-tight\">{title}</h1>}\n              {subtitle && <p className=\"text-sm text-muted-foreground\">{subtitle}</p>}\n            </div>\n            {actions && <div className=\"shrink-0\">{actions}</div>}\n          </div>\n        </header>\n      )}\n      <div className=\"flex-1 overflow-y-auto px-4 pb-24 pt-4 md:pb-8\">{children}</div>\n    </section>\n  );\n}\r\n"],"names":[],"mappings":";;;;;AACA;;;AAUO,SAAS,YAAY,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAoB;IAC7F,qBACE,8OAAC;QAAQ,WAAW,IAAA,kHAAE,EAAC,wBAAwB;;YAC5C,CAAC,SAAS,YAAY,OAAO,mBAC5B,8OAAC;gBAAO,WAAU;0BAChB,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;;gCACE,uBAAS,8OAAC;oCAAG,WAAU;8CAAwC;;;;;;gCAC/D,0BAAY,8OAAC;oCAAE,WAAU;8CAAiC;;;;;;;;;;;;wBAE5D,yBAAW,8OAAC;4BAAI,WAAU;sCAAY;;;;;;;;;;;;;;;;;0BAI7C,8OAAC;gBAAI,WAAU;0BAAkD;;;;;;;;;;;;AAGvE","debugId":null}},
    {"offset": {"line": 83, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lokes/Desktop/projects/whatsnext/components/TrackingToggle.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { PermissionStateMaybe } from \"@/lib/tracking/store\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ninterface TrackingToggleProps {\r\n  trackingOn: boolean;\r\n  permissionStatus: PermissionStateMaybe;\r\n  toggleTracking: () => void;\r\n  error?: string | null;\r\n}\r\n\r\nexport function TrackingToggle({ trackingOn, permissionStatus, toggleTracking, error }: TrackingToggleProps) {\r\n  const statusCopy = buildStatus(permissionStatus, error);\r\n\r\n  return (\r\n    <button\r\n      type=\"button\"\r\n      onClick={toggleTracking}\r\n      className={cn(\r\n        \"flex items-center gap-3 rounded-2xl border px-4 py-3 shadow-sm transition hover:border-primary\",\r\n        trackingOn ? \"bg-emerald-600 text-white\" : \"bg-muted text-foreground\"\r\n      )}\r\n      aria-pressed={trackingOn}\r\n    >\r\n      <div className=\"relative inline-flex h-5 w-10 items-center rounded-full bg-white/30 p-0.5\">\r\n        <span\r\n          className={cn(\r\n            \"inline-block h-4 w-4 rounded-full bg-white transition\",\r\n            trackingOn ? \"translate-x-5\" : \"translate-x-0\"\r\n          )}\r\n        />\r\n      </div>\r\n      <div className=\"text-left\">\r\n        <p className=\"text-sm font-semibold leading-tight\">Live Suggestions</p>\r\n        <p className=\"text-xs text-muted-foreground/90\">\r\n          {trackingOn ? \"Tracking enabled\" : \"Tap to start\"} | {statusCopy}\r\n        </p>\r\n      </div>\r\n    </button>\r\n  );\r\n}\r\n\r\nfunction buildStatus(permission: PermissionStateMaybe, error?: string | null) {\r\n  if (error) return error;\r\n  switch (permission) {\r\n    case \"granted\":\r\n      return \"Foreground only\";\r\n    case \"denied\":\r\n      return \"Permission denied\";\r\n    case \"prompt\":\r\n      return \"Requires GPS access\";\r\n    case \"unsupported\":\r\n      return \"GPS unsupported\";\r\n    default:\r\n      return permission || \"\";\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;AAGA;AAHA;;;AAYO,SAAS,eAAe,EAAE,UAAU,EAAE,gBAAgB,EAAE,cAAc,EAAE,KAAK,EAAuB;IACzG,MAAM,aAAa,YAAY,kBAAkB;IAEjD,qBACE,8OAAC;QACC,MAAK;QACL,SAAS;QACT,WAAW,IAAA,kHAAE,EACX,kGACA,aAAa,8BAA8B;QAE7C,gBAAc;;0BAEd,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBACC,WAAW,IAAA,kHAAE,EACX,yDACA,aAAa,kBAAkB;;;;;;;;;;;0BAIrC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAE,WAAU;kCAAsC;;;;;;kCACnD,8OAAC;wBAAE,WAAU;;4BACV,aAAa,qBAAqB;4BAAe;4BAAI;;;;;;;;;;;;;;;;;;;AAKhE;AAEA,SAAS,YAAY,UAAgC,EAAE,KAAqB;IAC1E,IAAI,OAAO,OAAO;IAClB,OAAQ;QACN,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT;YACE,OAAO,cAAc;IACzB;AACF","debugId":null}},
    {"offset": {"line": 169, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lokes/Desktop/projects/whatsnext/components/LiveStatusChip.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ninterface LiveStatusChipProps {\r\n  trackingOn: boolean;\r\n  lastPingAt: string | null;\r\n  permissionStatus: string;\r\n}\r\n\r\nexport function LiveStatusChip({ trackingOn, lastPingAt, permissionStatus }: LiveStatusChipProps) {\r\n  const [description, setDescription] = useState(\"--\");\r\n\r\n  useEffect(() => {\r\n    if (!lastPingAt) {\r\n      setDescription(\"No GPS yet\");\r\n      return;\r\n    }\r\n    const update = () => {\r\n      const seconds = Math.floor((Date.now() - Date.parse(lastPingAt)) / 1000);\r\n      if (seconds < 5) setDescription(\"Just now\");\r\n      else setDescription(`${seconds}s ago`);\r\n    };\r\n    update();\r\n    const id = setInterval(update, 5000);\r\n    return () => clearInterval(id);\r\n  }, [lastPingAt]);\r\n\r\n  let label = \"Paused\";\r\n  let color = \"bg-muted text-foreground\";\r\n\r\n  if (trackingOn && lastPingAt && Date.now() - Date.parse(lastPingAt) < 15000) {\r\n    label = \"Live | Updating\";\r\n    color = \"bg-emerald-600 text-white\";\r\n  } else if (!trackingOn) {\r\n    label = \"Paused\";\r\n  } else if (permissionStatus === \"denied\") {\r\n    label = \"No GPS\";\r\n    color = \"bg-amber-500 text-white\";\r\n  } else {\r\n    label = \"Waiting\";\r\n    color = \"bg-muted text-foreground\";\r\n  }\r\n\r\n  const detailClass = color.includes(\"text-white\") ? \"text-white/80\" : \"text-muted-foreground\";\r\n\r\n  return (\r\n    <div className={cn(\"inline-flex flex-col rounded-2xl px-4 py-2 text-xs font-medium\", color)}>\r\n      <span className=\"text-sm font-semibold leading-none\">{label}</span>\r\n      <span className={cn(\"text-[11px] leading-tight\", detailClass)}>\r\n        Last update: {description}\r\n      </span>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAWO,SAAS,eAAe,EAAE,UAAU,EAAE,UAAU,EAAE,gBAAgB,EAAuB;IAC9F,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAC;IAE/C,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,YAAY;YACf,eAAe;YACf;QACF;QACA,MAAM,SAAS;YACb,MAAM,UAAU,KAAK,KAAK,CAAC,CAAC,KAAK,GAAG,KAAK,KAAK,KAAK,CAAC,WAAW,IAAI;YACnE,IAAI,UAAU,GAAG,eAAe;iBAC3B,eAAe,GAAG,QAAQ,KAAK,CAAC;QACvC;QACA;QACA,MAAM,KAAK,YAAY,QAAQ;QAC/B,OAAO,IAAM,cAAc;IAC7B,GAAG;QAAC;KAAW;IAEf,IAAI,QAAQ;IACZ,IAAI,QAAQ;IAEZ,IAAI,cAAc,cAAc,KAAK,GAAG,KAAK,KAAK,KAAK,CAAC,cAAc,OAAO;QAC3E,QAAQ;QACR,QAAQ;IACV,OAAO,IAAI,CAAC,YAAY;QACtB,QAAQ;IACV,OAAO,IAAI,qBAAqB,UAAU;QACxC,QAAQ;QACR,QAAQ;IACV,OAAO;QACL,QAAQ;QACR,QAAQ;IACV;IAEA,MAAM,cAAc,MAAM,QAAQ,CAAC,gBAAgB,kBAAkB;IAErE,qBACE,8OAAC;QAAI,WAAW,IAAA,kHAAE,EAAC,kEAAkE;;0BACnF,8OAAC;gBAAK,WAAU;0BAAsC;;;;;;0BACtD,8OAAC;gBAAK,WAAW,IAAA,kHAAE,EAAC,6BAA6B;;oBAAc;oBAC/C;;;;;;;;;;;;;AAItB","debugId":null}},
    {"offset": {"line": 246, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lokes/Desktop/projects/whatsnext/lib/api-client.ts"],"sourcesContent":["export type ApiError = {\n  code: string;\n  message: string;\n  details?: unknown;\n};\n\nasync function parseJson<T>(res: Response): Promise<T | null> {\n  if (res.status === 204) return null;\n  const contentType = res.headers.get(\"content-type\");\n  if (contentType && contentType.includes(\"application/json\")) {\n    return (await res.json()) as T;\n  }\n  return null;\n}\n\nasync function handleResponse<T>(\n  res: Response\n): Promise<{ data: T | null; error: ApiError | null }> {\n  if (res.ok) {\n    const data = await parseJson<T>(res);\n    return { data, error: null };\n  }\n\n  const payload =\n    (await parseJson<{ error?: { code: string; message: string; details?: unknown } }>(\n      res\n    )) || undefined;\n\n  const error: ApiError = {\n    code: payload?.error?.code || `HTTP_${res.status}`,\n    message: payload?.error?.message || res.statusText,\n    details: payload?.error?.details,\n  };\n  return { data: null, error };\n}\n\nexport async function apiGet<T>(url: string) {\n  const res = await fetch(url, { cache: \"no-store\" });\n  return handleResponse<T>(res);\n}\n\nexport async function apiPost<T, B = unknown>(url: string, body: B) {\n  const res = await fetch(url, {\n    method: \"POST\",\n    headers: { \"content-type\": \"application/json\" },\n    body: JSON.stringify(body),\n  });\n  return handleResponse<T>(res);\n}\n\nexport type RecommendationZone = {\n  zone_id: number;\n  zone_name: string;\n  distance_km: number;\n  eta_min: number;\n  score: number;\n  reason: string;\n  expected_fare_inr?: number;\n  normalized_fare?: number;\n  traffic_penalty?: number;\n};\n\nexport type RecommendationResponse = {\n  computed_at: string;\n  source?: string;\n  context?: Record<string, unknown> | null;\n  top: RecommendationZone[];\n};\n\nexport type DriverState = {\n  driver_id: string;\n  last_ping_at: string | null;\n  lat: number | null;\n  lon: number | null;\n  snapped_zone: number | null;\n  snapped_zone_id?: number | null;\n  speed_kmh: number | null;\n  battery_pct: number | null;\n  recommendation: RecommendationResponse | null;\n  updated_at: string | null;\n};\n\nexport type DriverStateResponse = DriverState | null;\n\nexport type PingPayload = {\n  lat: number;\n  lon: number;\n  ts?: string;\n  speed_kmh?: number | null;\n  battery_pct?: number | null;\n  traffic_context?: Record<string, unknown>;\n};\n\nexport async function postPing(payload: PingPayload) {\n  return apiPost<{ zone_id: number | null; recommendation: RecommendationResponse | null }>(\n    \"/api/pings\",\n    payload\n  );\n}\n\nexport async function fetchDriverState() {\n  return apiGet<DriverStateResponse>(\"/api/driver-state\");\n}\n\nexport async function fetchRecommendations(params?: {\n  lat?: number;\n  lon?: number;\n  k?: number;\n}) {\n  const qs = new URLSearchParams();\n  if (params?.lat !== undefined) qs.set(\"lat\", String(params.lat));\n  if (params?.lon !== undefined) qs.set(\"lon\", String(params.lon));\n  if (params?.k !== undefined) qs.set(\"k\", String(params.k));\n  const suffix = qs.toString();\n  return apiGet<RecommendationResponse>(\n    `/api/recommendations/next-spot${suffix ? `?${suffix}` : \"\"}`\n  );\n}\n\nexport type RideEventPayload = {\n  event_type: \"booking_received\" | \"ride_started\" | \"ride_completed\" | \"booking_cancelled\";\n  platform: \"ola\" | \"uber\";\n  pickup_lat?: number;\n  pickup_lon?: number;\n  drop_lat?: number;\n  drop_lon?: number;\n  surge_multiplier?: number;\n  promo_code?: string;\n};\n\nexport async function postRideEvent(payload: RideEventPayload) {\n  return apiPost<{ ok: boolean; event_id: number | null }>(\"/api/ride-events/ingest\", {\n    occurred_at: new Date().toISOString(),\n    ...payload,\n  });\n}\n\nexport type OpsDailyInput = {\n  day?: string;\n  platforms?: (\"ola\" | \"uber\")[];\n  idle_minutes?: number;\n  energy_kwh?: number;\n  energy_cost_inr?: number;\n  fuel_litres?: number;\n  fuel_cost_inr?: number;\n  tolls_parking_inr?: number;\n  notes?: string;\n};\n\nexport async function upsertOpsDaily(payload: OpsDailyInput) {\n  return apiPost<{\n    driver_id: string;\n    day: string;\n    idle_minutes: number | null;\n    energy_kwh: number | null;\n    energy_cost_inr: number | null;\n    tolls_parking_inr: number | null;\n    notes: string | null;\n  }>(\"/api/ops-daily/upsert\", payload);\n}\n\nexport type TripSyncPayload = {\n  booking_at?: string;\n  pickup_at: string;\n  drop_at: string;\n  pickup_lat: number;\n  pickup_lon: number;\n  drop_lat: number;\n  drop_lon: number;\n  distance_km: number;\n  fare_inr: number;\n  platform: \"ola\" | \"uber\";\n  surge_multiplier?: number;\n  promo_code?: string;\n  tip_inr?: number;\n};\n\nexport async function postTripSync(payload: TripSyncPayload) {\n  return apiPost<{ trip_id: number | null }>(\"/api/trips/sync\", payload);\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAMA,eAAe,UAAa,GAAa;IACvC,IAAI,IAAI,MAAM,KAAK,KAAK,OAAO;IAC/B,MAAM,cAAc,IAAI,OAAO,CAAC,GAAG,CAAC;IACpC,IAAI,eAAe,YAAY,QAAQ,CAAC,qBAAqB;QAC3D,OAAQ,MAAM,IAAI,IAAI;IACxB;IACA,OAAO;AACT;AAEA,eAAe,eACb,GAAa;IAEb,IAAI,IAAI,EAAE,EAAE;QACV,MAAM,OAAO,MAAM,UAAa;QAChC,OAAO;YAAE;YAAM,OAAO;QAAK;IAC7B;IAEA,MAAM,UACJ,AAAC,MAAM,UACL,QACI;IAER,MAAM,QAAkB;QACtB,MAAM,SAAS,OAAO,QAAQ,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;QAClD,SAAS,SAAS,OAAO,WAAW,IAAI,UAAU;QAClD,SAAS,SAAS,OAAO;IAC3B;IACA,OAAO;QAAE,MAAM;QAAM;IAAM;AAC7B;AAEO,eAAe,OAAU,GAAW;IACzC,MAAM,MAAM,MAAM,MAAM,KAAK;QAAE,OAAO;IAAW;IACjD,OAAO,eAAkB;AAC3B;AAEO,eAAe,QAAwB,GAAW,EAAE,IAAO;IAChE,MAAM,MAAM,MAAM,MAAM,KAAK;QAC3B,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,OAAO,eAAkB;AAC3B;AA6CO,eAAe,SAAS,OAAoB;IACjD,OAAO,QACL,cACA;AAEJ;AAEO,eAAe;IACpB,OAAO,OAA4B;AACrC;AAEO,eAAe,qBAAqB,MAI1C;IACC,MAAM,KAAK,IAAI;IACf,IAAI,QAAQ,QAAQ,WAAW,GAAG,GAAG,CAAC,OAAO,OAAO,OAAO,GAAG;IAC9D,IAAI,QAAQ,QAAQ,WAAW,GAAG,GAAG,CAAC,OAAO,OAAO,OAAO,GAAG;IAC9D,IAAI,QAAQ,MAAM,WAAW,GAAG,GAAG,CAAC,KAAK,OAAO,OAAO,CAAC;IACxD,MAAM,SAAS,GAAG,QAAQ;IAC1B,OAAO,OACL,CAAC,8BAA8B,EAAE,SAAS,CAAC,CAAC,EAAE,QAAQ,GAAG,IAAI;AAEjE;AAaO,eAAe,cAAc,OAAyB;IAC3D,OAAO,QAAkD,2BAA2B;QAClF,aAAa,IAAI,OAAO,WAAW;QACnC,GAAG,OAAO;IACZ;AACF;AAcO,eAAe,eAAe,OAAsB;IACzD,OAAO,QAQJ,yBAAyB;AAC9B;AAkBO,eAAe,aAAa,OAAwB;IACzD,OAAO,QAAoC,mBAAmB;AAChE","debugId":null}},
    {"offset": {"line": 337, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lokes/Desktop/projects/whatsnext/lib/hooks/useDriverState.ts"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useEffect, useState } from \"react\";\nimport { DriverState, fetchDriverState } from \"@/lib/api-client\";\n\nexport function useDriverState(pollMs: number = 0) {\n  const [data, setData] = useState<DriverState | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  const load = useCallback(async () => {\n    const { data, error } = await fetchDriverState();\n    if (error) {\n      setError(error.message);\n    } else {\n      setError(null);\n      setData(data);\n    }\n    setLoading(false);\n  }, []);\n\n  useEffect(() => {\n    load();\n    if (pollMs > 0) {\n      const id = setInterval(load, pollMs);\n      return () => clearInterval(id);\n    }\n  }, [load, pollMs]);\n\n  return { data, loading, error, refresh: load };\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;AAKO,SAAS,eAAe,SAAiB,CAAC;IAC/C,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAqB;IACrD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAgB;IAElD,MAAM,OAAO,IAAA,oNAAW,EAAC;QACvB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,IAAA,wIAAgB;QAC9C,IAAI,OAAO;YACT,SAAS,MAAM,OAAO;QACxB,OAAO;YACL,SAAS;YACT,QAAQ;QACV;QACA,WAAW;IACb,GAAG,EAAE;IAEL,IAAA,kNAAS,EAAC;QACR;QACA,IAAI,SAAS,GAAG;YACd,MAAM,KAAK,YAAY,MAAM;YAC7B,OAAO,IAAM,cAAc;QAC7B;IACF,GAAG;QAAC;QAAM;KAAO;IAEjB,OAAO;QAAE;QAAM;QAAS;QAAO,SAAS;IAAK;AAC/C","debugId":null}},
    {"offset": {"line": 381, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lokes/Desktop/projects/whatsnext/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nconst Card = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\r\n      \"rounded-2xl border bg-card text-card-foreground shadow-sm\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n));\r\nCard.displayName = \"Card\";\r\n\r\nconst CardHeader = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\r\n    {...props}\r\n  />\r\n));\r\nCardHeader.displayName = \"CardHeader\";\r\n\r\nconst CardTitle = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLHeadingElement>\r\n>(({ className, ...props }, ref) => (\r\n  <h3\r\n    ref={ref}\r\n    className={cn(\r\n      \"text-2xl font-semibold leading-none tracking-tight\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n));\r\nCardTitle.displayName = \"CardTitle\";\r\n\r\nconst CardDescription = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, ...props }, ref) => (\r\n  <p\r\n    ref={ref}\r\n    className={cn(\"text-sm text-muted-foreground\", className)}\r\n    {...props}\r\n  />\r\n));\r\nCardDescription.displayName = \"CardDescription\";\r\n\r\nconst CardContent = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\r\n));\r\nCardContent.displayName = \"CardContent\";\r\n\r\nconst CardFooter = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"flex items-center p-6 pt-0\", className)}\r\n    {...props}\r\n  />\r\n));\r\nCardFooter.displayName = \"CardFooter\";\r\n\r\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent };\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA;AACA;;;;AAEA,MAAM,qBAAO,mNAAgB,CAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,6DACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,mNAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,mNAAgB,CAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,mNAAgB,CAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,mNAAgB,CAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QAAI,KAAK;QAAK,WAAW,IAAA,kHAAE,EAAC,YAAY;QAAa,GAAG,KAAK;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,mNAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 466, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lokes/Desktop/projects/whatsnext/components/NextZonesPanel.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\r\nimport { RecommendationResponse, fetchRecommendations } from \"@/lib/api-client\";\r\nimport { useDriverState } from \"@/lib/hooks/useDriverState\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { ArrowUpRight, MapPin, RefreshCw } from \"lucide-react\";\r\nimport { formatDistanceToNow } from \"date-fns\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ninterface NextZonesPanelProps {\r\n  trackingOn: boolean;\r\n  seedRecommendation?: RecommendationResponse | null;\r\n}\r\n\r\nconst STALE_MS = 45_000;\r\n\r\nexport function NextZonesPanel({ trackingOn, seedRecommendation }: NextZonesPanelProps) {\r\n  const { data: driverState } = useDriverState();\r\n  const [recommendation, setRecommendation] = useState<RecommendationResponse | null>(\r\n    seedRecommendation ?? null\r\n  );\r\n  const [loading, setLoading] = useState(!seedRecommendation);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const hydrateFromState = useCallback(() => {\r\n    if (driverState?.recommendation) {\r\n      const rec = driverState.recommendation;\r\n      if (Date.now() - Date.parse(rec.computed_at) < STALE_MS) {\r\n        setRecommendation(rec);\r\n        setError(null);\r\n        setLoading(false);\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }, [driverState]);\r\n\r\n  const fetchLatest = useCallback(async () => {\r\n    setLoading(true);\r\n    const { data, error } = await fetchRecommendations({ k: 3 });\r\n    if (error) {\r\n      setError(error.message);\r\n    } else {\r\n      setError(null);\r\n      setRecommendation(data);\r\n    }\r\n    setLoading(false);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!seedRecommendation) {\r\n      if (!hydrateFromState()) {\r\n        fetchLatest();\r\n      }\r\n    }\r\n  }, [seedRecommendation, hydrateFromState, fetchLatest]);\r\n\r\n  useEffect(() => {\r\n    hydrateFromState();\r\n  }, [driverState, hydrateFromState]);\r\n\r\n  useEffect(() => {\r\n    if (!trackingOn) return;\r\n    const id = setInterval(() => fetchLatest(), 15000);\r\n    return () => clearInterval(id);\r\n  }, [trackingOn, fetchLatest]);\r\n\r\n  const empty = !loading && !error && (!recommendation || recommendation.top.length === 0);\r\n  const computedAgo = recommendation?.computed_at\r\n    ? formatDistanceToNow(new Date(recommendation.computed_at), { addSuffix: true })\r\n    : null;\r\n\r\n  return (\r\n    <Card className=\"shadow-sm\">\r\n      <CardHeader className=\"flex flex-row items-center justify-between space-y-0\">\r\n        <div>\r\n          <CardTitle className=\"text-base font-semibold\">Next best zones</CardTitle>\r\n          <p className=\"text-xs text-muted-foreground\">\r\n            Refreshed {computedAgo ?? \"just now\"}\r\n          </p>\r\n        </div>\r\n        <Button variant=\"ghost\" size=\"icon\" aria-label=\"Refresh\" onClick={fetchLatest}>\r\n          <RefreshCw className=\"h-4 w-4\" />\r\n        </Button>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-4\">\r\n        {loading && (\r\n          <div className=\"space-y-3\">\r\n            {[0, 1, 2].map((idx) => (\r\n              <div key={idx} className=\"rounded-xl border p-3\">\r\n                <div className=\"h-4 w-1/2 animate-pulse rounded bg-muted\" />\r\n                <div className=\"mt-2 h-3 w-1/3 animate-pulse rounded bg-muted\" />\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {!loading && error && (\r\n          <div className=\"rounded-xl border border-red-200 bg-red-50 p-4 text-sm text-red-700\">\r\n            {error}\r\n            <Button size=\"sm\" variant=\"secondary\" className=\"mt-3\" onClick={fetchLatest}>\r\n              Try again\r\n            </Button>\r\n          </div>\r\n        )}\r\n\r\n        {empty && (\r\n          <div className=\"rounded-xl border border-dashed p-4 text-sm text-muted-foreground\">\r\n            We’ll start suggesting zones once we see your location.\r\n          </div>\r\n        )}\r\n\r\n        {!loading && !error && recommendation?.top?.length ? (\r\n          <div className=\"space-y-3\">\r\n            {recommendation.top.map((zone) => (\r\n              <ZoneCard key={zone.zone_id} zone={zone} />\r\n            ))}\r\n          </div>\r\n        ) : null}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n\r\nfunction ZoneCard({ zone }: { zone: RecommendationResponse[\"top\"][number] }) {\r\n  const barWidth = `${Math.min(100, Math.round(zone.score * 100))}%`;\r\n\r\n  const handleNavigate = () => {\r\n    const q = encodeURIComponent(`${zone.zone_name} Patna`);\r\n    window.open(`https://www.google.com/maps/search/?api=1&query=${q}`, \"_blank\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"rounded-2xl border p-4\">\r\n      <div className=\"flex items-start justify-between gap-3\">\r\n        <div>\r\n          <div className=\"flex items-center gap-2 text-base font-semibold\">\r\n            <MapPin className=\"h-4 w-4 text-primary\" />\r\n            {zone.zone_name}\r\n          </div>\r\n          <p className=\"text-xs text-muted-foreground\">\r\n            {zone.distance_km.toFixed(1)} km | {zone.eta_min} min | Score {zone.score.toFixed(2)}\r\n          </p>\r\n        </div>\r\n        <Button size=\"sm\" variant=\"secondary\" onClick={handleNavigate}>\r\n          Navigate\r\n          <ArrowUpRight className=\"ml-1 h-3 w-3\" />\r\n        </Button>\r\n      </div>\r\n      <div className=\"mt-3 text-sm text-muted-foreground\">{zone.reason}</div>\r\n      <div className=\"mt-3 h-1.5 rounded-full bg-muted\">\r\n        <div className=\"h-full rounded-full bg-emerald-500\" style={{ width: barWidth }} />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 812, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lokes/Desktop/projects/whatsnext/components/RideControls.tsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo, useState } from \"react\";\nimport { Button, type ButtonProps } from \"@/components/ui/button\";\nimport { postRideEvent } from \"@/lib/api-client\";\nimport type { TrackingFix } from \"@/lib/tracking/store\";\nimport { toast } from \"sonner\";\n\ntype RideEventAction =\n  | \"booking_received\"\n  | \"ride_started\"\n  | \"ride_completed\"\n  | \"booking_cancelled\";\n\nconst events: Array<{ type: RideEventAction; label: string; variant: ButtonProps[\"variant\"] }> = [\n  { type: \"booking_received\", label: \"Got a Ride\", variant: \"default\" },\n  { type: \"ride_started\", label: \"Ride Started\", variant: \"secondary\" },\n  { type: \"ride_completed\", label: \"Ride Completed\", variant: \"outline\" },\n  { type: \"booking_cancelled\", label: \"Booking Cancelled\", variant: \"ghost\" },\n] as const;\n\ntype EventConfig = (typeof events)[number];\n\ninterface RideControlsProps {\n  lastFix: TrackingFix | null;\n}\n\nexport function RideControls({ lastFix }: RideControlsProps) {\n  const [platform, setPlatform] = useState<\"ola\" | \"uber\">(\"ola\");\n  const [activeEvent, setActiveEvent] = useState<EventConfig | null>(null);\n  const [submitting, setSubmitting] = useState(false);\n\n  const coordsCopy = useMemo(() => {\n    if (!lastFix) return \"No live GPS\";\n    return `${lastFix.lat.toFixed(4)}, ${lastFix.lon.toFixed(4)}`;\n  }, [lastFix]);\n\n  const confirmEvent = async () => {\n    if (!activeEvent) return;\n    setSubmitting(true);\n    const payload: Parameters<typeof postRideEvent>[0] = {\n      event_type: activeEvent.type,\n      platform,\n    };\n    if (lastFix) {\n      if (activeEvent.type === \"ride_completed\") {\n        payload.drop_lat = lastFix.lat;\n        payload.drop_lon = lastFix.lon;\n      } else {\n        payload.pickup_lat = lastFix.lat;\n        payload.pickup_lon = lastFix.lon;\n      }\n    }\n    const { error } = await postRideEvent(payload);\n    setSubmitting(false);\n    setActiveEvent(null);\n    if (error) {\n      toast.error(error.message);\n    } else {\n      toast.success(`${copyForEvent(activeEvent.type)} logged`);\n    }\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex items-center justify-between rounded-2xl border bg-white/60 px-4 py-3 shadow-sm\">\n        <div>\n          <p className=\"text-xs uppercase text-muted-foreground\">Current platform</p>\n          <div className=\"mt-1 inline-flex gap-2 rounded-full bg-muted p-1\">\n            {[\"ola\", \"uber\"].map((provider) => (\n              <button\n                key={provider}\n                type=\"button\"\n                onClick={() => setPlatform(provider as \"ola\" | \"uber\")}\n                className={`rounded-full px-3 py-1 text-xs font-semibold capitalize transition ${\n                  platform === provider\n                    ? \"bg-white text-foreground shadow\"\n                    : \"text-muted-foreground\"\n                }`}\n              >\n                {provider}\n              </button>\n            ))}\n          </div>\n        </div>\n        <div className=\"text-right text-xs text-muted-foreground\">\n          <p>Last fix</p>\n          <p className=\"font-semibold text-foreground\">{coordsCopy}</p>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-2 gap-3\">\n        {events.map((event) => (\n          <Button\n            key={event.type}\n            className={event.type === \"booking_received\" ? \"col-span-2 h-14 text-base\" : \"h-12\"}\n            variant={event.variant}\n            onClick={() => setActiveEvent(event)}\n          >\n            {event.label}\n          </Button>\n        ))}\n      </div>\n\n      <p className=\"text-xs text-muted-foreground\">\n        Your live location is only used to suggest better zones and calculate your performance. It stays private to you.\n      </p>\n\n      {activeEvent && (\n        <div className=\"fixed inset-0 z-50 flex items-end justify-center bg-black/40 px-4 pb-8\">\n          <div className=\"w-full max-w-md rounded-3xl bg-bg p-5 shadow-2xl\">\n            <p className=\"text-sm font-semibold text-muted-foreground\">Confirm action</p>\n            <h3 className=\"text-2xl font-semibold\">{activeEvent.label}</h3>\n            <p className=\"mt-2 text-sm text-muted-foreground\">\n              Platform: <span className=\"font-medium capitalize\">{platform}</span>\n            </p>\n            <p className=\"text-sm text-muted-foreground\">\n              Location: <span className=\"font-medium\">{coordsCopy}</span>\n            </p>\n            <div className=\"mt-5 flex gap-3\">\n              <Button variant=\"outline\" className=\"flex-1\" onClick={() => setActiveEvent(null)}>\n                Cancel\n              </Button>\n              <Button className=\"flex-1\" onClick={confirmEvent} disabled={submitting}>\n                {submitting ? \"Saving…\" : \"Confirm\"}\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction copyForEvent(type: EventConfig[\"type\"]) {\n  switch (type) {\n    case \"booking_received\":\n      return \"Booking\";\n    case \"ride_started\":\n      return \"Ride start\";\n    case \"ride_completed\":\n      return \"Ride completion\";\n    case \"booking_cancelled\":\n      return \"Cancellation\";\n    default:\n      return \"Event\";\n  }\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1103, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lokes/Desktop/projects/whatsnext/lib/tracking/store.ts"],"sourcesContent":["\"use client\";\n\nimport { create } from \"zustand\";\nimport type { RecommendationResponse } from \"@/lib/api-client\";\n\nexport type PermissionStateMaybe = PermissionState | \"prompt\" | \"unsupported\";\n\nexport type TrackingFix = {\n  lat: number;\n  lon: number;\n  accuracy?: number | null;\n  speed?: number | null;\n  timestamp: number;\n};\n\ninterface TrackingState {\n  trackingOn: boolean;\n  permissionStatus: PermissionStateMaybe;\n  lastFix: TrackingFix | null;\n  lastPingAt: string | null;\n  lastRecommendation: RecommendationResponse | null;\n  error: string | null;\n  setTrackingOn: (next: boolean) => void;\n  setPermissionStatus: (status: PermissionStateMaybe) => void;\n  setLastFix: (fix: TrackingFix | null) => void;\n  setLastPingAt: (iso: string | null) => void;\n  setRecommendation: (rec: RecommendationResponse | null) => void;\n  setError: (message: string | null) => void;\n}\n\nexport const useTrackingStore = create<TrackingState>((set) => ({\n  trackingOn: false,\n  permissionStatus: \"prompt\",\n  lastFix: null,\n  lastPingAt: null,\n  lastRecommendation: null,\n  error: null,\n  setTrackingOn: (trackingOn) => set({ trackingOn }),\n  setPermissionStatus: (permissionStatus) => set({ permissionStatus }),\n  setLastFix: (lastFix) => set({ lastFix }),\n  setLastPingAt: (lastPingAt) => set({ lastPingAt }),\n  setRecommendation: (lastRecommendation) => set({ lastRecommendation }),\n  setError: (error) => set({ error }),\n}));\r\n"],"names":[],"mappings":";;;;AAEA;AAFA;;AA8BO,MAAM,mBAAmB,IAAA,kKAAM,EAAgB,CAAC,MAAQ,CAAC;QAC9D,YAAY;QACZ,kBAAkB;QAClB,SAAS;QACT,YAAY;QACZ,oBAAoB;QACpB,OAAO;QACP,eAAe,CAAC,aAAe,IAAI;gBAAE;YAAW;QAChD,qBAAqB,CAAC,mBAAqB,IAAI;gBAAE;YAAiB;QAClE,YAAY,CAAC,UAAY,IAAI;gBAAE;YAAQ;QACvC,eAAe,CAAC,aAAe,IAAI;gBAAE;YAAW;QAChD,mBAAmB,CAAC,qBAAuB,IAAI;gBAAE;YAAmB;QACpE,UAAU,CAAC,QAAU,IAAI;gBAAE;YAAM;IACnC,CAAC","debugId":null}},
    {"offset": {"line": 1140, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lokes/Desktop/projects/whatsnext/lib/offline-queue.ts"],"sourcesContent":["import { openDB, IDBPDatabase } from \"idb\";\r\n\r\nconst DB = \"ride-db\";\r\nconst STORE = \"events\";\r\n\r\nasync function db() { \r\n  return openDB(DB, 1, { \r\n    upgrade(d: IDBPDatabase) { \r\n      d.createObjectStore(STORE, { keyPath: \"id\", autoIncrement: true }); \r\n    } \r\n  }); \r\n}\r\n\r\nexport async function enqueue(e: any) { \r\n  (await db()).add(STORE, { ...e, created_at: Date.now() }); \r\n}\r\n\r\nexport async function drain(flush: (e: any) => Promise<boolean>) {\r\n  const d = await db();\r\n  const tx = d.transaction(STORE, \"readwrite\");\r\n  const s = tx.store;\r\n  let c = await s.openCursor();\r\n  while (c) { \r\n    const ok = await flush(c.value); \r\n    if (ok) await c.delete(); \r\n    c = await c.continue(); \r\n  }\r\n  await tx.done;\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,KAAK;AACX,MAAM,QAAQ;AAEd,eAAe;IACb,OAAO,IAAA,+IAAM,EAAC,IAAI,GAAG;QACnB,SAAQ,CAAe;YACrB,EAAE,iBAAiB,CAAC,OAAO;gBAAE,SAAS;gBAAM,eAAe;YAAK;QAClE;IACF;AACF;AAEO,eAAe,QAAQ,CAAM;IAClC,CAAC,MAAM,IAAI,EAAE,GAAG,CAAC,OAAO;QAAE,GAAG,CAAC;QAAE,YAAY,KAAK,GAAG;IAAG;AACzD;AAEO,eAAe,MAAM,KAAmC;IAC7D,MAAM,IAAI,MAAM;IAChB,MAAM,KAAK,EAAE,WAAW,CAAC,OAAO;IAChC,MAAM,IAAI,GAAG,KAAK;IAClB,IAAI,IAAI,MAAM,EAAE,UAAU;IAC1B,MAAO,EAAG;QACR,MAAM,KAAK,MAAM,MAAM,EAAE,KAAK;QAC9B,IAAI,IAAI,MAAM,EAAE,MAAM;QACtB,IAAI,MAAM,EAAE,QAAQ;IACtB;IACA,MAAM,GAAG,IAAI;AACf","debugId":null}},
    {"offset": {"line": 1182, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lokes/Desktop/projects/whatsnext/hooks/useLiveTracking.ts"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useEffect, useRef } from \"react\";\nimport { postPing, RecommendationResponse } from \"@/lib/api-client\";\nimport { useTrackingStore } from \"@/lib/tracking/store\";\nimport { enqueue } from \"@/lib/offline-queue\";\nimport { toast } from \"sonner\";\n\nconst MIN_DISTANCE_DELTA = 30; // meters\nconst MIN_INTERVAL_MS = 5000;\n\ntype GeoPermissionDescriptor = { name: \"geolocation\" };\n\nexport function useLiveTracking() {\n  const trackingOn = useTrackingStore((s) => s.trackingOn);\n  const permissionStatus = useTrackingStore((s) => s.permissionStatus);\n  const lastFix = useTrackingStore((s) => s.lastFix);\n  const lastPingAt = useTrackingStore((s) => s.lastPingAt);\n  const lastRecommendation = useTrackingStore((s) => s.lastRecommendation);\n  const error = useTrackingStore((s) => s.error);\n  const setTrackingOn = useTrackingStore((s) => s.setTrackingOn);\n  const setPermissionStatus = useTrackingStore((s) => s.setPermissionStatus);\n  const setLastFix = useTrackingStore((s) => s.setLastFix);\n  const setLastPingAt = useTrackingStore((s) => s.setLastPingAt);\n  const setRecommendation = useTrackingStore((s) => s.setRecommendation);\n  const setError = useTrackingStore((s) => s.setError);\n  const watchId = useRef<number | null>(null);\n  const lastSentTimestamp = useRef<number>(0);\n  const lastPosition = useRef<GeolocationPosition | null>(null);\n\n  const updatePermissionFromNavigator = useCallback(async () => {\n    try {\n      if (navigator.permissions?.query) {\n        const result = await navigator.permissions.query(\n          { name: \"geolocation\" } as PermissionDescriptor & GeoPermissionDescriptor\n        );\n        setPermissionStatus(result.state);\n        result.onchange = () => setPermissionStatus(result.state);\n      } else {\n        setPermissionStatus(\"unsupported\");\n      }\n    } catch (err) {\n      console.warn(\"permission query failed\", err);\n      setPermissionStatus(\"unsupported\");\n    }\n  }, [setPermissionStatus]);\n\n  useEffect(() => {\n    updatePermissionFromNavigator();\n  }, [updatePermissionFromNavigator]);\n\n  const stopWatch = useCallback(() => {\n    if (watchId.current !== null) {\n      navigator.geolocation.clearWatch(watchId.current);\n      watchId.current = null;\n    }\n  }, []);\n\n  const handlePingSuccess = useCallback(\n    (recommendation: RecommendationResponse | null, timestampIso: string) => {\n      setLastPingAt(timestampIso);\n      if (recommendation) {\n        setRecommendation(recommendation);\n      }\n      setError(null);\n    },\n    [setLastPingAt, setRecommendation, setError]\n  );\n\n  const sendPing = useCallback(\n    async (position: GeolocationPosition) => {\n      const now = Date.now();\n      const last = lastPosition.current;\n      if (last) {\n        const deltaMeters = distanceMeters(last.coords, position.coords);\n        if (deltaMeters < MIN_DISTANCE_DELTA && now - lastSentTimestamp.current < MIN_INTERVAL_MS) {\n          return;\n        }\n      }\n\n      lastPosition.current = position;\n\n      const payload = {\n        lat: position.coords.latitude,\n        lon: position.coords.longitude,\n        ts: new Date(position.timestamp).toISOString(),\n        speed_kmh: position.coords.speed ? position.coords.speed * 3.6 : undefined,\n      };\n\n      setLastFix({\n        lat: payload.lat,\n        lon: payload.lon,\n        accuracy: position.coords.accuracy,\n        speed: payload.speed_kmh ?? null,\n        timestamp: position.timestamp,\n      });\n\n      lastSentTimestamp.current = now;\n\n      const { data, error } = await postPing(payload);\n      if (error) {\n        setError(error.message);\n        await enqueue(payload);\n        toast.error(\"Could not sync live location. We'll retry soon.\");\n        return;\n      }\n\n      handlePingSuccess(data?.recommendation ?? null, payload.ts ?? new Date().toISOString());\n    },\n    [setLastFix, handlePingSuccess, setError]\n  );\n\n  const requestPermission = useCallback(async () => {\n    try {\n      const { state } = await navigator.permissions.query(\n        { name: \"geolocation\" } as PermissionDescriptor & GeoPermissionDescriptor\n      );\n      setPermissionStatus(state);\n      if (state === \"denied\") {\n        toast.error(\"Location permission denied. Enable it in browser settings.\");\n        return false;\n      }\n      if (state === \"prompt\") {\n        await new Promise<GeolocationPosition>((resolve, reject) => {\n          navigator.geolocation.getCurrentPosition(resolve, reject, {\n            enableHighAccuracy: true,\n            timeout: 10000,\n          });\n        });\n        setPermissionStatus(\"granted\");\n      }\n      return true;\n    } catch (error) {\n      console.error(\"permission request failed\", error);\n      setPermissionStatus(\"unsupported\");\n      return false;\n    }\n  }, [setPermissionStatus]);\n\n  const toggleTracking = useCallback(async () => {\n    if (trackingOn) {\n      stopWatch();\n      setTrackingOn(false);\n      return;\n    }\n\n    const granted = await requestPermission();\n    if (!granted) {\n      setError(\"Location permission required for live tracking\");\n      return;\n    }\n\n    setTrackingOn(true);\n  }, [trackingOn, requestPermission, stopWatch, setTrackingOn, setError]);\n\n  useEffect(() => {\n    if (!trackingOn) {\n      stopWatch();\n      return;\n    }\n\n    watchId.current = navigator.geolocation.watchPosition(\n      (pos) => sendPing(pos),\n      (err) => {\n        console.error(\"watchPosition error\", err);\n        setError(err.message);\n        if (err.code === err.PERMISSION_DENIED) {\n          setTrackingOn(false);\n          setPermissionStatus(\"denied\");\n          toast.error(\"Permission denied. Please re-enable location access.\");\n        }\n      },\n      {\n        enableHighAccuracy: true,\n        maximumAge: 5000,\n        timeout: 15000,\n      }\n    );\n\n    return () => stopWatch();\n  }, [trackingOn, sendPing, stopWatch, setError, setTrackingOn, setPermissionStatus]);\n\n  useEffect(() => {\n    function handleOnline() {\n      setError(null);\n    }\n    window.addEventListener(\"online\", handleOnline);\n    return () => window.removeEventListener(\"online\", handleOnline);\n  }, [setError]);\n\n  return {\n    trackingOn,\n    permissionStatus,\n    lastFix,\n    lastPingAt,\n    lastRecommendation,\n    error,\n    toggleTracking,\n  };\n}\n\nfunction distanceMeters(a: GeolocationCoordinates, b: GeolocationCoordinates) {\n  const R = 6371e3;\n  const lat1 = (a.latitude * Math.PI) / 180;\n  const lat2 = (b.latitude * Math.PI) / 180;\n  const deltaLat = lat2 - lat1;\n  const deltaLon = ((b.longitude - a.longitude) * Math.PI) / 180;\n  const x =\n    Math.sin(deltaLat / 2) * Math.sin(deltaLat / 2) +\n    Math.cos(lat1) * Math.cos(lat2) * Math.sin(deltaLon / 2) * Math.sin(deltaLon / 2);\n  const c = 2 * Math.atan2(Math.sqrt(x), Math.sqrt(1 - x));\n  return R * c;\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1399, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lokes/Desktop/projects/whatsnext/lib/supabase/config.ts"],"sourcesContent":["const isServer = () => typeof window === \"undefined\";\n\nfunction readEnv(key: string) {\n  try {\n    return process.env[key];\n  } catch {\n    return undefined;\n  }\n}\n\nexport function getSupabaseConfig() {\n  const url = isServer()\n    ? readEnv(\"SUPABASE_URL\") ?? readEnv(\"NEXT_PUBLIC_SUPABASE_URL\")\n    : readEnv(\"NEXT_PUBLIC_SUPABASE_URL\");\n  const anonKey = isServer()\n    ? readEnv(\"SUPABASE_ANON_KEY\") ?? readEnv(\"NEXT_PUBLIC_SUPABASE_ANON_KEY\")\n    : readEnv(\"NEXT_PUBLIC_SUPABASE_ANON_KEY\");\n\n  if (!url) {\n    throw new Error(\"Missing SUPABASE_URL/NEXT_PUBLIC_SUPABASE_URL environment variable\");\n  }\n  if (!anonKey) {\n    throw new Error(\"Missing SUPABASE_ANON_KEY/NEXT_PUBLIC_SUPABASE_ANON_KEY environment variable\");\n  }\n\n  return { url, anonKey };\n}\n"],"names":[],"mappings":";;;;AAAA,MAAM,WAAW,IAAM,kDAAkB;AAEzC,SAAS,QAAQ,GAAW;IAC1B,IAAI;QACF,OAAO,QAAQ,GAAG,CAAC,IAAI;IACzB,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,SAAS;IACd,MAAM,MAAM,aACR,QAAQ,mBAAmB,QAAQ,8BACnC;IACJ,MAAM,UAAU,aACZ,QAAQ,wBAAwB,QAAQ,mCACxC;IAEJ,IAAI,CAAC,KAAK;QACR,MAAM,IAAI,MAAM;IAClB;IACA,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO;QAAE;QAAK;IAAQ;AACxB","debugId":null}},
    {"offset": {"line": 1429, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lokes/Desktop/projects/whatsnext/lib/supabase/client.ts"],"sourcesContent":["\"use client\";\n\nimport { createClient, type SupabaseClient } from \"@supabase/supabase-js\";\nimport { getSupabaseConfig } from \"./config\";\n\nlet browserClient: SupabaseClient | null = null;\n\nexport function createBrowserSupabaseClient() {\n  if (typeof window === \"undefined\") {\n    throw new Error(\"createBrowserSupabaseClient must only be called in the browser\");\n  }\n\n  if (browserClient) {\n    return browserClient;\n  }\n\n  const { url, anonKey } = getSupabaseConfig();\n  browserClient = createClient(url, anonKey, {\n    auth: {\n      persistSession: true,\n      detectSessionInUrl: true,\n      autoRefreshToken: true,\n    },\n  });\n\n  return browserClient;\n}\n\nexport function getBrowserSupabaseClient() {\n  return createBrowserSupabaseClient();\n}\n"],"names":[],"mappings":";;;;;;AAEA;AACA;AAHA;;;AAKA,IAAI,gBAAuC;AAEpC,SAAS;IACd,wCAAmC;QACjC,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI,eAAe;QACjB,OAAO;IACT;IAEA,MAAM,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,IAAA,8IAAiB;IAC1C,gBAAgB,IAAA,uMAAY,EAAC,KAAK,SAAS;QACzC,MAAM;YACJ,gBAAgB;YAChB,oBAAoB;YACpB,kBAAkB;QACpB;IACF;IAEA,OAAO;AACT;AAEO,SAAS;IACd,OAAO;AACT","debugId":null}},
    {"offset": {"line": 1465, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lokes/Desktop/projects/whatsnext/lib/hooks/useDriverProfile.ts"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { createBrowserSupabaseClient } from \"@/lib/supabase/client\";\n\nconst supabase = createBrowserSupabaseClient();\n\nexport function useDriverProfile() {\n  const [profile, setProfile] = useState<{ id: string; full_name: string | null } | null>(null);\n\n  useEffect(() => {\n    let active = true;\n    async function load() {\n      const {\n        data: { user },\n      } = await supabase.auth.getUser();\n      if (!user) return;\n      const { data } = await supabase\n        .from(\"profiles\")\n        .select(\"id,full_name\")\n        .eq(\"id\", user.id)\n        .maybeSingle();\n      if (!active) return;\n      setProfile({ id: user.id, full_name: data?.full_name ?? user.user_metadata?.full_name ?? null });\n    }\n    load();\n    return () => {\n      active = false;\n    };\n  }, []);\n\n  return profile;\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;AAKA,MAAM,WAAW,IAAA,wJAA2B;AAErC,SAAS;IACd,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAkD;IAExF,IAAA,kNAAS,EAAC;QACR,IAAI,SAAS;QACb,eAAe;YACb,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;YAC/B,IAAI,CAAC,MAAM;YACX,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,SACpB,IAAI,CAAC,YACL,MAAM,CAAC,gBACP,EAAE,CAAC,MAAM,KAAK,EAAE,EAChB,WAAW;YACd,IAAI,CAAC,QAAQ;YACb,WAAW;gBAAE,IAAI,KAAK,EAAE;gBAAE,WAAW,MAAM,aAAa,KAAK,aAAa,EAAE,aAAa;YAAK;QAChG;QACA;QACA,OAAO;YACL,SAAS;QACX;IACF,GAAG,EAAE;IAEL,OAAO;AACT","debugId":null}},
    {"offset": {"line": 1500, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lokes/Desktop/projects/whatsnext/app/%28driver%29/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { DriverShell } from \"@/components/layout/DriverShell\";\r\nimport { TrackingToggle } from \"@/components/TrackingToggle\";\r\nimport { LiveStatusChip } from \"@/components/LiveStatusChip\";\r\nimport { NextZonesPanel } from \"@/components/NextZonesPanel\";\r\nimport { RideControls } from \"@/components/RideControls\";\r\nimport { useLiveTracking } from \"@/hooks/useLiveTracking\";\r\nimport { useDriverProfile } from \"@/lib/hooks/useDriverProfile\";\r\nimport { useTodayStats } from \"@/lib/hooks/useTodayStats\";\r\n\r\nexport default function DriverHomePage() {\r\n  const tracking = useLiveTracking();\r\n  const profile = useDriverProfile();\r\n  const { stats } = useTodayStats();\r\n\r\n  const greeting = profile?.full_name ? `Hi, ${profile.full_name.split(\" \")[0]}` : \"Hi driver\";\r\n  const subtitle = `Today | ${stats.totalTrips} trips | ₹${stats.totalEarnings.toFixed(0)}`;\r\n\r\n  return (\r\n    <DriverShell title={greeting} subtitle={subtitle}>\r\n      <div className=\"space-y-6\">\r\n        <div className=\"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between\">\r\n          <TrackingToggle\r\n            trackingOn={tracking.trackingOn}\r\n            permissionStatus={tracking.permissionStatus}\r\n            toggleTracking={tracking.toggleTracking}\r\n            error={tracking.error}\r\n          />\r\n          <LiveStatusChip\r\n            trackingOn={tracking.trackingOn}\r\n            lastPingAt={tracking.lastPingAt}\r\n            permissionStatus={tracking.permissionStatus}\r\n          />\r\n        </div>\r\n\r\n        <NextZonesPanel trackingOn={tracking.trackingOn} seedRecommendation={tracking.lastRecommendation} />\r\n\r\n        <section className=\"space-y-3\">\r\n          <h2 className=\"text-lg font-semibold\">Ride actions</h2>\r\n          <RideControls lastFix={tracking.lastFix} />\r\n        </section>\r\n      </div>\r\n    </DriverShell>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;;;;;;;;;;AAWe,SAAS;IACtB,MAAM,WAAW,IAAA,2IAAe;IAChC,MAAM,UAAU,IAAA,oJAAgB;IAChC,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,8IAAa;IAE/B,MAAM,WAAW,SAAS,YAAY,CAAC,IAAI,EAAE,QAAQ,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,EAAE,GAAG;IACjF,MAAM,WAAW,CAAC,QAAQ,EAAE,MAAM,UAAU,CAAC,UAAU,EAAE,MAAM,aAAa,CAAC,OAAO,CAAC,IAAI;IAEzF,qBACE,8OAAC,mJAAW;QAAC,OAAO;QAAU,UAAU;kBACtC,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,+IAAc;4BACb,YAAY,SAAS,UAAU;4BAC/B,kBAAkB,SAAS,gBAAgB;4BAC3C,gBAAgB,SAAS,cAAc;4BACvC,OAAO,SAAS,KAAK;;;;;;sCAEvB,8OAAC,+IAAc;4BACb,YAAY,SAAS,UAAU;4BAC/B,YAAY,SAAS,UAAU;4BAC/B,kBAAkB,SAAS,gBAAgB;;;;;;;;;;;;8BAI/C,8OAAC,+IAAc;oBAAC,YAAY,SAAS,UAAU;oBAAE,oBAAoB,SAAS,kBAAkB;;;;;;8BAEhG,8OAAC;oBAAQ,WAAU;;sCACjB,8OAAC;4BAAG,WAAU;sCAAwB;;;;;;sCACtC,8OAAC,2IAAY;4BAAC,SAAS,SAAS,OAAO;;;;;;;;;;;;;;;;;;;;;;;AAKjD","debugId":null}}]
}